
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>src.utils package &#8212; Emotion Measurement 1.0.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="src.utils.logging package" href="src.utils.logging.html" />
    <link rel="prev" title="src.experiment package" href="src.experiment.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="src-utils-package">
<h1>src.utils package<a class="headerlink" href="#src-utils-package" title="Permalink to this heading">¶</a></h1>
<section id="subpackages">
<h2>Subpackages<a class="headerlink" href="#subpackages" title="Permalink to this heading">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="src.utils.logging.html">src.utils.logging package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="src.utils.logging.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="src.utils.logging.html#module-src.utils.logging.base_logger">src.utils.logging.base_logger module</a></li>
<li class="toctree-l2"><a class="reference internal" href="src.utils.logging.html#module-src.utils.logging.pytorch_logger">src.utils.logging.pytorch_logger module</a></li>
<li class="toctree-l2"><a class="reference internal" href="src.utils.logging.html#module-src.utils.logging.standard_logger">src.utils.logging.standard_logger module</a></li>
<li class="toctree-l2"><a class="reference internal" href="src.utils.logging.html#module-src.utils.logging.tensorflow_logger">src.utils.logging.tensorflow_logger module</a></li>
<li class="toctree-l2"><a class="reference internal" href="src.utils.logging.html#module-src.utils.logging">Module contents</a></li>
</ul>
</li>
</ul>
</div>
</section>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this heading">¶</a></h2>
</section>
<section id="module-src.utils.ground_truth">
<span id="src-utils-ground-truth-module"></span><h2>src.utils.ground_truth module<a class="headerlink" href="#module-src.utils.ground_truth" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="src.utils.ground_truth.FaceAPIThread">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">src.utils.ground_truth.</span></span><span class="sig-name descname"><span class="pre">FaceAPIThread</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">port</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logging</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.utils.ground_truth.FaceAPIThread" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Thread</span></code></p>
<p>Thread that runs face-api.js as a background server.</p>
<dl class="py method">
<dt class="sig sig-object py" id="src.utils.ground_truth.FaceAPIThread.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#src.utils.ground_truth.FaceAPIThread.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Thread run function that starts a subprocess with face-api.js
that listens on localhost:self.port/emotions.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="src.utils.ground_truth.FaceAPIThread.stop">
<span class="sig-name descname"><span class="pre">stop</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#src.utils.ground_truth.FaceAPIThread.stop" title="Permalink to this definition">¶</a></dt>
<dd><p>Stop function that stops the subprocess and the API.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.utils.ground_truth.experiment_ground_truth">
<span class="sig-prename descclassname"><span class="pre">src.utils.ground_truth.</span></span><span class="sig-name descname"><span class="pre">experiment_ground_truth</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">video_file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#src.utils.ground_truth.experiment_ground_truth" title="Permalink to this definition">¶</a></dt>
<dd><p>Main function that creates ground truth for the experiments
using face expression emotions from face-api.js.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>video_file</strong> – The video_file to compute the emotions for.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-src.utils.metrics">
<span id="src-utils-metrics-module"></span><h2>src.utils.metrics module<a class="headerlink" href="#module-src.utils.metrics" title="Permalink to this heading">¶</a></h2>
<p>Implement interesting metrics to use them later.</p>
<dl class="py function">
<dt class="sig sig-object py" id="src.utils.metrics.accuracy">
<span class="sig-prename descclassname"><span class="pre">src.utils.metrics.</span></span><span class="sig-name descname"><span class="pre">accuracy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prediction</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="headerlink" href="#src.utils.metrics.accuracy" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the accuracy of predictions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>labels</strong> – Labels array.</p></li>
<li><p><strong>prediction</strong> – Predicitions array from classifier.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Accuracy</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.utils.metrics.per_class_accuracy">
<span class="sig-prename descclassname"><span class="pre">src.utils.metrics.</span></span><span class="sig-name descname"><span class="pre">per_class_accuracy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prediction</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="headerlink" href="#src.utils.metrics.per_class_accuracy" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the average per class accuracy of predictions.
This is equivalent to the average recall per class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>labels</strong> – Labels array.</p></li>
<li><p><strong>prediction</strong> – Predicitions array from classifier.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Per class accuracy average</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.utils.metrics.precision">
<span class="sig-prename descclassname"><span class="pre">src.utils.metrics.</span></span><span class="sig-name descname"><span class="pre">precision</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prediction</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="headerlink" href="#src.utils.metrics.precision" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the precision of predictions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>labels</strong> – Labels array.</p></li>
<li><p><strong>prediction</strong> – Predicitions array from classifier.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Precision</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.utils.metrics.recall">
<span class="sig-prename descclassname"><span class="pre">src.utils.metrics.</span></span><span class="sig-name descname"><span class="pre">recall</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prediction</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="headerlink" href="#src.utils.metrics.recall" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the recall of predictions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>labels</strong> – Labels array.</p></li>
<li><p><strong>prediction</strong> – Predicitions array from classifier.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Recall</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-src.utils.training">
<span id="src-utils-training-module"></span><h2>src.utils.training module<a class="headerlink" href="#module-src.utils.training" title="Permalink to this heading">¶</a></h2>
<p>Implement training loops for all the classifiers for testing them.</p>
<dl class="py function">
<dt class="sig sig-object py" id="src.utils.training.cv_training_loop">
<span class="sig-prename descclassname"><span class="pre">src.utils.training.</span></span><span class="sig-name descname"><span class="pre">cv_training_loop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">classifier</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv_splits</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#src.utils.training.cv_training_loop" title="Permalink to this definition">¶</a></dt>
<dd><p>Implements an example training loop for a classifier that is running
in cross validation mode. This means that the dataset is split into
‘cv_splits’ subsets, one of them is used for validation, another one for
testing and the rest for training. This function trains ‘cv_splits’
separate models in order to get one model for every element in the data.
This trains the classifiers, saves the models, then loads the classifiers
and runs inference on the test sets. It then prints the accuracy and
average accuracy of the different classifiers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cv_splits</strong> – How many splits to use for the dataset.</p></li>
<li><p><strong>classifier</strong> – The classifier instance to train here.</p></li>
<li><p><strong>parameters</strong> – The parameters used for training the classifier.</p></li>
<li><p><strong>save_path</strong> – The save path to save the classifier at.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.utils.training.reader_main">
<span class="sig-prename descclassname"><span class="pre">src.utils.training.</span></span><span class="sig-name descname"><span class="pre">reader_main</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#src.utils.training.reader_main" title="Permalink to this definition">¶</a></dt>
<dd><p>Main method that can be used to see if a data reader works as expected.
This creates a dataset and prints the shapes and counts of the classes
on the test set.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>reader</strong> – The data reader instance to evaluate.</p></li>
<li><p><strong>parameters</strong> – Parameters for the data reader.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="src.utils.training.training_loop">
<span class="sig-prename descclassname"><span class="pre">src.utils.training.</span></span><span class="sig-name descname"><span class="pre">training_loop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">classifier</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#src.utils.training.training_loop" title="Permalink to this definition">¶</a></dt>
<dd><p>Implements an example training loop for a normal classifier.
This trains the classifier, saves the model, then loads the classifier
and runs inference on the test set. It then prints the accuracy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>classifier</strong> – The classifier instance to train here.</p></li>
<li><p><strong>parameters</strong> – The parameters used for training the classifier.</p></li>
<li><p><strong>save_path</strong> – The save path to save the classifier at.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-src.utils">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-src.utils" title="Permalink to this heading">¶</a></h2>
<p>Utility functions and other code.</p>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">Emotion Measurement</a></h1>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">emotion-recognition</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="src.html">src package</a></li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
  <li><a href="modules.html">emotion-recognition</a><ul>
  <li><a href="src.html">src package</a><ul>
      <li>Previous: <a href="src.experiment.html" title="previous chapter">src.experiment package</a></li>
      <li>Next: <a href="src.utils.logging.html" title="next chapter">src.utils.logging package</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2022, Jakob Kruse.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 5.1.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="_sources/src.utils.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>